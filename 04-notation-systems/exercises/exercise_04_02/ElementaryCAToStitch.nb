(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     34387,        780]
NotebookOptionsPosition[     33829,        757]
NotebookOutlinePosition[     34172,        772]
CellTagsIndexPosition[     34129,        769]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{"\n", 
  RowBox[{
   RowBox[{
    RowBox[{"list", " ", "=", " ", 
     RowBox[{"Table", "[", 
      RowBox[{"0", ",", " ", 
       RowBox[{"{", "30", "}"}]}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"list", "[", 
      RowBox[{"[", "15", "]"}], "]"}], " ", "=", " ", "1"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"rules", " ", "=", " ", 
     RowBox[{"{", "\n", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0"}], "}"}], " ", "->", " ", "0"}], ",",
        "\n", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1"}], "}"}], " ", "->", " ", "1"}], ",",
        " ", "\n", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0"}], "}"}], " ", "->", " ", "1"}], ",",
        " ", "\n", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "1"}], "}"}], " ", "->", " ", "1"}], ",",
        " ", "\n", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "0", ",", "0"}], "}"}], " ", "->", 
        "\[NonBreakingSpace]", "0"}], ",", " ", "\n", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "0", ",", "1"}], "}"}], " ", "->", " ", "1"}], ",",
        "\n", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "1", ",", "0"}], "}"}], " ", "->", " ", "1"}], ",",
        "\n", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "1", ",", "1"}], "}"}], " ", "->", " ", "0"}]}], 
      "\n", "}"}]}], ";"}], "\n", 
   RowBox[{"(*", 
    RowBox[{
    "Chop", " ", "up", " ", "the", " ", "list", " ", "and", " ", "apply", " ",
      "the", " ", "rules"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"Partition", "[", 
      RowBox[{"list", ",", " ", "3", ",", " ", "1"}], "]"}], " ", "/.", " ", 
     "rules"}], ";"}], "\n", 
   RowBox[{"(*", 
    RowBox[{
    "Pad", " ", "the", " ", "list", " ", "with", " ", "zeros", " ", "on", " ",
      "both", " ", "sides"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"{", "0", "}"}], ",", " ", "list", ",", " ", 
      RowBox[{"{", "0", "}"}]}], "]"}], ";"}], "\n", 
   RowBox[{"(*", 
    RowBox[{
    "Create", " ", "a", " ", "function", " ", "to", " ", "do", " ", "this"}], 
    "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"step", "[", "seq_", "]"}], " ", ":=", " ", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"{", "0", "}"}], ",", " ", 
       RowBox[{
        RowBox[{"Partition", "[", 
         RowBox[{"seq", ",", " ", "3", ",", " ", "1"}], "]"}], " ", "/.", " ",
         "rules"}], ",", " ", 
       RowBox[{"{", "0", "}"}]}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"array", " ", "=", " ", 
     RowBox[{"NestList", "[", 
      RowBox[{"step", ",", " ", "list", ",", " ", "30"}], "]"}]}], ";"}], 
   "\n", "\n", 
   RowBox[{
    RowBox[{"summarizedArray", " ", "=", " ", 
     RowBox[{"{", "}"}]}], ";"}], "\n", "\n", 
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"i", " ", "=", " ", "1"}], ",", " ", 
     RowBox[{"i", "\[LessEqual]", " ", 
      RowBox[{"Length", "[", "array", "]"}]}], ",", " ", 
     RowBox[{"++", "i"}], ",", "\n", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"row", " ", "i"}], " ", "*)"}], "\n", "\t", 
     RowBox[{
      RowBox[{"line", " ", "=", " ", 
       RowBox[{"{", "}"}]}], ";", "\n", "\t", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"j", "=", "1"}], ",", " ", 
        RowBox[{"j", "\[LessEqual]", " ", 
         RowBox[{"Length", "[", 
          RowBox[{"array", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ",", " ", 
        RowBox[{"++", "j"}], ",", "\n", "\t\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "line", "]"}], " ", "\[Equal]", " ", "0"}], 
          ",", " ", 
          RowBox[{"(*", " ", "init", " ", "*)"}], "\n", "\t\t\t", 
          RowBox[{"line", " ", "=", " ", 
           RowBox[{"{", 
            RowBox[{"i", ",", "j", ",", "i", ",", "j", ",", " ", 
             RowBox[{"array", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "}"}]}], ",", " ", 
          "\n", "\t\t", 
          RowBox[{"(*", 
           RowBox[{"else", ":", " ", 
            RowBox[{
            "if", " ", "value", " ", "is", " ", "the", " ", "same", " ", "as",
              " ", "last", " ", 
             RowBox[{"line", "'"}], "s", " ", "value"}]}], "*)"}], "\n", 
          "\t\t\t", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"array", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "j"}], "]"}], "]"}], " ", "\[Equal]", " ", 
             RowBox[{"line", "[", 
              RowBox[{"[", "5", "]"}], "]"}]}], ",", "\n", "\t\t\t\t", 
            RowBox[{"line", " ", "=", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"line", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
               RowBox[{"line", "[", 
                RowBox[{"[", "2", "]"}], "]"}], ",", " ", "i", ",", "j", ",", 
               " ", 
               RowBox[{"line", "[", 
                RowBox[{"[", "5", "]"}], "]"}]}], "}"}]}], ",", "\n", 
            "\t\t\t\t", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"else", ":", " ", 
               RowBox[{
                RowBox[{"new", " ", 
                 RowBox[{"value", " ", "--"}]}], ">", " ", 
                RowBox[{"store", " ", "old", " ", "line"}]}]}], ",", " ", 
              RowBox[{"start", " ", "new", " ", "line"}]}], "*)"}], "\n", 
            "\t\t\t\t", 
            RowBox[{
             RowBox[{"summarizedArray", " ", "=", " ", 
              RowBox[{"Append", "[", 
               RowBox[{"summarizedArray", ",", " ", "line"}], "]"}]}], ";", 
             " ", 
             RowBox[{"line", " ", "=", " ", 
              RowBox[{"{", 
               RowBox[{"i", ",", "j", ",", "i", ",", "j", ",", 
                RowBox[{"array", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "}"}]}]}]}], 
           "]"}]}], "\n", "\t\t", "]"}]}], "\n", "\t", "]"}]}]}], "\n", "]"}],
    "\n", 
   RowBox[{
    RowBox[{"SubArrayToLine", "[", "a_", "]"}], " ", ":=", " ", 
    RowBox[{"(", "\n", "\t", 
     RowBox[{
      RowBox[{"p1", " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"a", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "-", "0.5"}], ",", " ", 
         RowBox[{"-", 
          RowBox[{"a", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}]}], ";", "\n", "\t", 
      RowBox[{"p2", " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"a", "[", 
           RowBox[{"[", "4", "]"}], "]"}], "+", "0.5"}], ",", " ", 
         RowBox[{"-", 
          RowBox[{"a", "[", 
           RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}]}], ";", "\n", "\t", 
      RowBox[{"l", " ", "=", " ", 
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{"p1", ",", " ", "p2"}], "}"}], "]"}]}], ";", "\n", "\t", 
      RowBox[{"Return", "[", "l", "]"}], ";"}], "\n", ")"}]}], "\n", 
   RowBox[{
    RowBox[{"FormattingOfLine", "[", "x_", "]"}], ":=", 
    RowBox[{"(", "\n", "\t", 
     RowBox[{
      RowBox[{"Return", "[", " ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"x", " ", "\[Equal]", " ", "0"}], " ", ",", " ", "Orange", 
         ",", " ", "Black"}], "]"}], "]"}], ";"}], "\n", ")"}]}], "\n", "\n", 
   RowBox[{
    RowBox[{"FormatRawLineList", "[", "x_", "]"}], ":=", 
    RowBox[{"(", "\n", "\t", 
     RowBox[{
      RowBox[{"formattedLines", " ", "=", " ", 
       RowBox[{"{", "}"}]}], ";", "\n", "\t", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"k", " ", "=", " ", "1"}], ",", " ", 
        RowBox[{"k", " ", "\[LessEqual]", " ", 
         RowBox[{"Length", "[", "x", "]"}]}], ",", 
        RowBox[{"++", "k"}], ",", "\n", "\t\t", 
        RowBox[{
         RowBox[{"formattedLines", " ", "=", " ", 
          RowBox[{"Append", "[", 
           RowBox[{"formattedLines", ",", " ", 
            RowBox[{"FormattingOfLine", "[", 
             RowBox[{"x", "[", 
              RowBox[{"[", 
               RowBox[{"k", ",", "5"}], "]"}], "]"}], "]"}]}], "]"}]}], ";", 
         "\n", "\t\t", 
         RowBox[{"formattedLines", " ", "=", " ", 
          RowBox[{"Append", "[", 
           RowBox[{"formattedLines", ",", " ", 
            RowBox[{"SubArrayToLine", "[", 
             RowBox[{"x", "[", 
              RowBox[{"[", "k", "]"}], "]"}], "]"}]}], "]"}]}], ";"}]}], "\n",
        "\t", "]"}], ";", "\n", "\t", 
      RowBox[{"Return", "[", "formattedLines", "]"}], ";"}], "\n", ")"}]}], 
   "\n", "\n", 
   RowBox[{
    RowBox[{"RemoveTrailingZeroLines", "[", "x_", "]"}], ":=", 
    RowBox[{"(", "\n", "\t", 
     RowBox[{
      RowBox[{"indicesToBeDropped", " ", "=", " ", 
       RowBox[{"{", "}"}]}], ";", "\n", "\t", 
      RowBox[{"(*", 
       RowBox[{"first", " ", "element"}], "*)"}], "\n", "\t", 
      RowBox[{
       RowBox[{"If", "[", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"x", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "5"}], "]"}], "]"}], "\[Equal]", "0"}], " ", 
         ",", " ", 
         RowBox[{"indicesToBeDropped", "=", 
          RowBox[{"Append", "[", 
           RowBox[{"indicesToBeDropped", ",", " ", 
            RowBox[{"{", "1", "}"}]}], "]"}]}], ",", " ", "0"}], "]"}], "\n", 
       "\t", 
       RowBox[{"(*", " ", "rest", " ", "*)"}], "\n", "\t", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "2"}], ",", 
         RowBox[{"i", "\[LessEqual]", 
          RowBox[{
           RowBox[{"Length", "[", "x", "]"}], "-", "1"}]}], ",", 
         RowBox[{"++", "i"}], ",", "\n", "\t\t", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
           "look", " ", "at", " ", "neighbors", " ", "left", " ", "and", " ", 
            "right"}], ",", " ", 
           RowBox[{"same", " ", "y", " ", 
            RowBox[{"value", "?"}]}]}], " ", "*)"}], "\n", "\t\t", 
         RowBox[{"If", "[", "    ", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"x", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "5"}], "]"}], "]"}], " ", "\[Equal]", " ", 
               "0"}], " ", "&&", " ", 
              RowBox[{
               RowBox[{"x", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "1"}], "]"}], "]"}], " ", "\[NotEqual]", 
               " ", 
               RowBox[{"x", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"i", "-", "1"}], ",", "1"}], "]"}], "]"}]}]}], 
             ")"}], "       ", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{"is", " ", "zero"}], "-", 
              RowBox[{"line", " ", "and", " ", "leading"}]}], " ", "*)"}], 
            "\n", "\t\t\t", "||", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"x", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "5"}], "]"}], "]"}], " ", "\[Equal]", " ", 
               "0"}], " ", "&&", " ", 
              RowBox[{
               RowBox[{"x", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "1"}], "]"}], "]"}], " ", "\[NotEqual]", 
               " ", 
               RowBox[{"x", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"i", "+", "1"}], ",", "1"}], "]"}], "]"}]}]}], 
             ")"}]}], ",", "       ", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{"is", " ", "zero"}], "-", 
             RowBox[{"line", " ", "and", " ", "trailing"}]}], " ", "*)"}], 
           "\n", "\t\t\t", 
           RowBox[{"indicesToBeDropped", "=", 
            RowBox[{"Append", "[", 
             RowBox[{"indicesToBeDropped", ",", " ", 
              RowBox[{"{", "i", "}"}]}], "]"}]}], ",", "\n", "\t\t\t", "0"}], 
          "]"}]}], "\n", "\t", "]"}], "\n", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{"last", " ", "element"}], " ", "*)"}], "\n", "\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Last", "[", "x", "]"}], "[", 
           RowBox[{"[", "5", "]"}], "]"}], "\[Equal]", "0"}], " ", ",", " ", 
         RowBox[{"indicesToBeDropped", " ", "=", " ", 
          RowBox[{"Append", "[", 
           RowBox[{"indicesToBeDropped", ",", 
            RowBox[{"{", 
             RowBox[{"Length", "[", "x", "]"}], "}"}]}], "]"}]}], ",", " ", 
         "0"}], "]"}]}], ";", "\n", "\t", 
      RowBox[{"Return", "[", 
       RowBox[{"Delete", "[", 
        RowBox[{"x", ",", " ", "indicesToBeDropped"}], "]"}], "]"}]}], "\n", 
     "\t", "\n", ")"}]}], "\n", "\n", 
   RowBox[{
    RowBox[{"AddRowStraddlingLines", "[", "x_", "]"}], ":=", 
    RowBox[{"(", "\n", "\t", 
     RowBox[{
      RowBox[{"resultList", " ", "=", " ", 
       RowBox[{"{", "}"}]}], ";", "\n", "\t", 
      RowBox[{
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "\[LessEqual]", 
          RowBox[{
           RowBox[{"Length", "[", "x", "]"}], "-", "1"}]}], ",", 
         RowBox[{"++", "i"}], ",", "\n", "\t\t", 
         RowBox[{
          RowBox[{"resultList", " ", "=", " ", 
           RowBox[{"Append", "[", 
            RowBox[{"resultList", ",", " ", 
             RowBox[{"x", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], ";", "\n", "\t\t", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"x", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "1"}], "]"}], "]"}], " ", "\[NotEqual]", 
              " ", 
              RowBox[{"x", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"i", "+", "1"}], ",", "1"}], "]"}], "]"}]}], " ", "&&",
              " ", 
             RowBox[{
              RowBox[{"x", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "5"}], "]"}], "]"}], " ", "\[Equal]", " ", 
              "1"}], " ", "&&", " ", 
             RowBox[{
              RowBox[{"x", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"i", "+", "1"}], ",", "5"}], "]"}], "]"}], " ", 
              "\[Equal]", " ", "1"}]}], ",", "   ", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{
              "next", " ", "line", " ", "has", " ", "different", " ", "y"}], 
              "-", "value"}], " ", "*)"}], "\n", "\t\t\t", 
            RowBox[{
             RowBox[{"tmp", " ", "=", " ", 
              RowBox[{"x", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], ";", "   ", 
             RowBox[{"resultList", " ", "=", " ", 
              RowBox[{"Append", "[", 
               RowBox[{"resultList", ",", " ", 
                RowBox[{"GetStraddlingLine", "[", 
                 RowBox[{
                  RowBox[{"x", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], ",", " ", 
                  RowBox[{"x", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", "+", "1"}], "]"}], "]"}], ",", " ", "i", ",",
                   " ", 
                  RowBox[{"x", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "5"}], "]"}], "]"}]}], "]"}]}], 
               "]"}]}]}], "\n", "\t\t\t", 
            RowBox[{"(*", 
             RowBox[{"resultList", " ", "=", " ", 
              RowBox[{"Append", "[", 
               RowBox[{"resultList", ",", " ", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"tmp", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
                  RowBox[{"tmp", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
                  RowBox[{"x", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"i", "+", "1"}], ",", "3"}], "]"}], "]"}], ",", 
                  " ", 
                  RowBox[{"x", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"i", "+", "1"}], ",", "4"}], "]"}], "]"}], ",", 
                  " ", "0"}], "}"}]}], "]"}]}], "*)"}], ",", "\n", "\t\t\t", 
            "0"}], "]"}], ";"}]}], "\n", "\t", "]"}], "\n", "\t", 
       RowBox[{"resultList", " ", "=", " ", 
        RowBox[{"Append", "[", 
         RowBox[{"resultList", ",", " ", 
          RowBox[{"Last", "[", "x", "]"}]}], "]"}]}]}], ";", "\n", "\t", 
      RowBox[{"Return", "[", "resultList", "]"}]}], "\n", ")"}]}], "\n", "\n", 
   RowBox[{
    RowBox[{"GetStraddlingLine", "[", 
     RowBox[{"x1_", ",", " ", "x2_", ",", " ", "i_", ",", " ", "type_"}], 
     "]"}], ":=", 
    RowBox[{"(", "\n", "\t", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Alternate", " ", "end"}], "-", 
         RowBox[{"end", " ", "/", " ", "start"}], "-", 
         RowBox[{"start", "\n", "\t", 
          RowBox[{"tmp", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}]}], ",", " ", 
        RowBox[{"tmp", "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
        RowBox[{"x", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"i", "+", "1"}], ",", "3"}], "]"}], "]"}], ",", " ", 
        RowBox[{"x", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"i", "+", "1"}], ",", "4"}], "]"}], "]"}], ",", " ", "0"}],
        "}"}], " ", "*)"}], "\n", "\t", 
     RowBox[{
      RowBox[{"i1", " ", "=", " ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Mod", "[", 
           RowBox[{"i", ",", "2"}], "]"}], "\[Equal]", "0"}], ",", " ", 
         RowBox[{"i1", " ", "=", " ", "1"}], ",", " ", 
         RowBox[{"i1", " ", "=", " ", "3"}]}], "]"}]}], ";", "\n", "\t", 
      RowBox[{"i2", " ", "=", " ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Mod", "[", 
           RowBox[{"i", ",", "2"}], "]"}], "\[Equal]", "0"}], ",", " ", 
         RowBox[{"i2", " ", "=", " ", "2"}], ",", " ", 
         RowBox[{"i2", " ", "=", " ", "4"}]}], "]"}]}], ";", "\n", "\t", 
      RowBox[{"i1", " ", "=", " ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Mod", "[", 
           RowBox[{"i", ",", "2"}], "]"}], "\[Equal]", "0"}], ",", " ", 
         RowBox[{"i3", " ", "=", " ", "3"}], ",", " ", 
         RowBox[{"i3", " ", "=", " ", "1"}]}], "]"}]}], ";", "\n", "\t", 
      RowBox[{"i1", " ", "=", " ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Mod", "[", 
           RowBox[{"i", ",", "2"}], "]"}], "\[Equal]", "0"}], ",", " ", 
         RowBox[{"i4", " ", "=", " ", "4"}], ",", " ", 
         RowBox[{"i4", " ", "=", " ", "2"}]}], "]"}]}], ";", "\n", "\t", 
      RowBox[{"line", " ", "=", " ", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"x1", "[", 
           RowBox[{"[", "i1", "]"}], "]"}], ",", " ", 
          RowBox[{"x1", "[", 
           RowBox[{"[", "i2", "]"}], "]"}], ",", " ", 
          RowBox[{"x2", "[", 
           RowBox[{"[", "i3", "]"}], "]"}], ",", " ", 
          RowBox[{"x2", "[", 
           RowBox[{"[", "i4", "]"}], "]"}], ",", " ", "type"}], "}"}], "\n", 
        "\t", 
        RowBox[{"Return", "[", "line", "]"}]}]}]}], "\n", ")"}]}], "\n", "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"formattedLines", " ", "=", " ", 
      RowBox[{"FormatRawLineList", "[", "summarizedArray", "]"}]}], ";", "\n", 
     RowBox[{"Graphics", "[", 
      RowBox[{"{", " ", 
       RowBox[{"Thick", ",", " ", "formattedLines"}], "}"}], "]"}]}], "*)"}], 
   "\n", 
   RowBox[{
    RowBox[{"trimmed", " ", "=", " ", 
     RowBox[{"RemoveTrailingZeroLines", "[", "summarizedArray", "]"}]}], 
    ";"}], "\n", 
   RowBox[{
    RowBox[{"a", " ", "=", " ", 
     RowBox[{"AddRowStraddlingLines", "[", "trimmed", "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"formatted", " ", "=", " ", 
     RowBox[{"FormatRawLineList", "[", "a", "]"}]}], ";"}], "\n", 
   RowBox[{"Graphics", "[", 
    RowBox[{"{", " ", 
     RowBox[{"Thick", ",", " ", "formatted"}], "}"}], "]"}], "\n", 
   RowBox[{
    RowBox[{"ArrayPlot", "[", "array", "]"}], ";"}]}]}]], "Code",
 CellChangeTimes->{{3.6248623702196913`*^9, 3.6248624662506514`*^9}, {
   3.6248625105810204`*^9, 3.6248626297210207`*^9}, 3.6248626802210207`*^9, {
   3.6248627192910204`*^9, 3.6248627232110205`*^9}, 3.6248627883410206`*^9, {
   3.6248628371910205`*^9, 3.62486286249102*^9}, {3.6248629010010204`*^9, 
   3.62486293174102*^9}, {3.62486298964202*^9, 3.6248630246150208`*^9}, 
   3.62486324935902*^9, 3.6248634708460207`*^9, {3.62486374510172*^9, 
   3.6248638448867083`*^9}, {3.624863901429536*^9, 3.62486399760295*^9}, {
   3.624864028203562*^9, 3.624864115765313*^9}, {3.6248641710874195`*^9, 
   3.62486420210804*^9}, {3.6248753291965923`*^9, 3.6248753422042713`*^9}, {
   3.624875479987209*^9, 3.6248754846052904`*^9}, {3.624875613867544*^9, 
   3.6248756468815737`*^9}, {3.6248756807932005`*^9, 3.624875716048727*^9}, {
   3.6248758302149057`*^9, 3.624876000926816*^9}, 3.6249825211094294`*^9, {
   3.624982816785902*^9, 3.6249828431855335`*^9}, {3.6249828942366295`*^9, 
   3.624982959818431*^9}, 3.624982989969567*^9, {3.6249833678329334`*^9, 
   3.624983453927432*^9}, {3.624983498478188*^9, 3.6249835039018106`*^9}, 
   3.624983620300548*^9, {3.6249836635184145`*^9, 3.6249837663000593`*^9}, {
   3.624983807020255*^9, 3.6249838211166673`*^9}, {3.624983911566078*^9, 
   3.6249841302601366`*^9}, 3.6249843721396832`*^9, {3.6251554456544647`*^9, 
   3.625155452449009*^9}, {3.6251555264374666`*^9, 3.625155688542832*^9}, {
   3.6251557638341627`*^9, 3.6251557680069523`*^9}, {3.625155804911622*^9, 
   3.625155851167543*^9}, {3.6251559039248085`*^9, 3.625156204645835*^9}, {
   3.6251562404107413`*^9, 3.625156359060057*^9}, {3.6251563957625914`*^9, 
   3.6251564082519403`*^9}, 3.6251565925501404`*^9, {3.6251571512796392`*^9, 
   3.625157299781906*^9}, {3.6251573449160776`*^9, 3.6251575327056108`*^9}, {
   3.6251575759875436`*^9, 3.625157621427919*^9}, {3.6251576824897366`*^9, 
   3.625157729637254*^9}, {3.625157821255501*^9, 3.6251578294129524`*^9}, 
   3.625157907501152*^9, {3.625157958988572*^9, 3.625158127531237*^9}, {
   3.6251581589182205`*^9, 3.625158231602807*^9}, {3.62515828344246*^9, 
   3.6251583008981285`*^9}, {3.6251583358174715`*^9, 3.625158396592098*^9}, {
   3.6251585866604366`*^9, 3.625158630892*^9}, {3.62515866274129*^9, 
   3.6251587060122185`*^9}, {3.6251587433481765`*^9, 
   3.6251588164920692`*^9}, {3.625158908970889*^9, 3.6251589294505796`*^9}, {
   3.6251589829543447`*^9, 3.625159045313031*^9}, {3.6251591078368287`*^9, 
   3.6251591522104893`*^9}, {3.6251591904460497`*^9, 3.625159550449707*^9}, {
   3.6251595821939273`*^9, 3.6251595827452917`*^9}, {3.625159618033883*^9, 
   3.625159636736384*^9}, {3.6251596752401266`*^9, 3.625159734559778*^9}, 
   3.625159841748372*^9, {3.6251598797347636`*^9, 3.625159887067665*^9}, {
   3.6251599597012186`*^9, 3.6251599598443146`*^9}, {3.6251600640922537`*^9, 
   3.6251600854525332`*^9}, {3.625160133753772*^9, 3.6251601811714706`*^9}, {
   3.625160220707898*^9, 3.6251603359749513`*^9}, {3.625160374853941*^9, 
   3.6251603935124135`*^9}, {3.6251604327896695`*^9, 
   3.6251606299120746`*^9}, {3.625160671554912*^9, 3.6251607162407837`*^9}, {
   3.6251607526561265`*^9, 3.625160754656463*^9}, {3.6251608209787965`*^9, 
   3.625160866157001*^9}, {3.6251609003828783`*^9, 3.6251609183669*^9}, {
   3.625160987158886*^9, 3.6251610477093625`*^9}, {3.6251611017905164`*^9, 
   3.625161254821812*^9}, 3.625161338861989*^9, {3.625161397882445*^9, 
   3.625161401930151*^9}, {3.6251614444175525`*^9, 3.625161454057995*^9}, {
   3.625161497273884*^9, 3.625161542036809*^9}, {3.6251616166006517`*^9, 
   3.6251616263281536`*^9}, {3.6251616695230274`*^9, 
   3.6251618079395585`*^9}, {3.625241109318799*^9, 3.625241175197298*^9}, {
   3.625241252638912*^9, 3.62524125467027*^9}, {3.625241303110343*^9, 
   3.6252413843334084`*^9}, {3.6252414184133444`*^9, 3.625241419647784*^9}, {
   3.625241463166191*^9, 3.6252414657757044`*^9}, {3.6252415791098504`*^9, 
   3.6252415840007353`*^9}, {3.6252417309654083`*^9, 
   3.6252417327467527`*^9}, {3.6252417639202843`*^9, 
   3.6252418346740427`*^9}, {3.6252418679883127`*^9, 
   3.6252419309135303`*^9}, {3.6252419738845634`*^9, 
   3.6252420099646015`*^9}, {3.625242144268615*^9, 3.6252422122566013`*^9}, {
   3.6252422461021504`*^9, 3.625242385218916*^9}, {3.625242423814716*^9, 
   3.625242428658724*^9}, {3.625242478567625*^9, 3.6252425040533533`*^9}, {
   3.6252425506652*^9, 3.6252426039961624`*^9}, {3.625242651826829*^9, 
   3.6252426611241975`*^9}, {3.6252426959697995`*^9, 3.625242696344819*^9}, {
   3.6252427608638716`*^9, 3.625242764082793*^9}, {3.625242818320049*^9, 
   3.625242884370433*^9}, {3.625242915668971*^9, 3.625242935013749*^9}, {
   3.6252429670779514`*^9, 3.625243023752838*^9}, {3.625243055613905*^9, 
   3.62524306030165*^9}, {3.6252430953347654`*^9, 3.6252431033976917`*^9}, {
   3.6252431753858924`*^9, 3.6252431793236027`*^9}, {3.6252432142317066`*^9, 
   3.6252432161693106`*^9}, {3.6252432511399183`*^9, 3.62524330129883*^9}, {
   3.6252433379726553`*^9, 3.625243365942893*^9}, {3.6252433967414026`*^9, 
   3.625243525717004*^9}, {3.6252435567811503`*^9, 3.625243687881869*^9}, {
   3.6252437361188064`*^9, 3.625243759323165*^9}, {3.6252438664944324`*^9, 
   3.6252439692655153`*^9}, {3.6252441210392056`*^9, 3.625244285672951*^9}, {
   3.6252443175965223`*^9, 3.6252443355349755`*^9}, {3.625244366286605*^9, 
   3.6252444835897155`*^9}, {3.625244609346396*^9, 3.625244669974617*^9}, {
   3.6252447053514967`*^9, 3.625244729571533*^9}, {3.625244864844345*^9, 
   3.6252449169408617`*^9}, {3.6252451879865074`*^9, 
   3.6252452115190115`*^9}, {3.6252453085078144`*^9, 3.625245440163823*^9}, {
   3.6252454982046223`*^9, 3.625245622947012*^9}, {3.625245659154213*^9, 
   3.625245665523471*^9}, {3.625245701250354*^9, 3.6252457118484373`*^9}, 
   3.625245854185587*^9, {3.625246099959882*^9, 3.6252461711114445`*^9}, {
   3.625246359046073*^9, 3.6252464129010773`*^9}, {3.62524645295385*^9, 
   3.625246508889241*^9}, 3.625246551137484*^9, {3.6252467612089114`*^9, 
   3.6252467617522745`*^9}, {3.6252468743445377`*^9, 3.625246907097434*^9}, {
   3.625247018385828*^9, 3.6252471059763803`*^9}, {3.625247165394099*^9, 
   3.6252472203678484`*^9}, {3.6252472930614405`*^9, 3.625247587641362*^9}, {
   3.6252476264412985`*^9, 3.62524771715994*^9}, {3.625247748599959*^9, 
   3.6252478903367043`*^9}, {3.62524799679487*^9, 3.6252481076619835`*^9}, {
   3.6252482399033823`*^9, 3.625248299249055*^9}, {3.6252483434495993`*^9, 
   3.625248369167794*^9}, {3.6252483992489014`*^9, 3.6252484724058065`*^9}, {
   3.6252486037095814`*^9, 3.625248697710417*^9}, {3.625248738334572*^9, 
   3.6252487825261126`*^9}, {3.6252488228150463`*^9, 3.625248834979175*^9}, {
   3.625248905026005*^9, 3.6252489639623985`*^9}, {3.6252490683181577`*^9, 
   3.6252490992338266`*^9}, {3.625249132914341*^9, 3.625249330402356*^9}, {
   3.625249386302725*^9, 3.625249454443275*^9}, {3.6252494879776917`*^9, 
   3.6252495017328873`*^9}, {3.625249586462529*^9, 3.6252496262010913`*^9}, {
   3.62524972439173*^9, 3.6252497429721518`*^9}, {3.625249798661377*^9, 
   3.625249913475127*^9}, {3.62524995937381*^9, 3.625249974060629*^9}, {
   3.6252500528182745`*^9, 3.6252500549857235`*^9}, {3.625250086052491*^9, 
   3.625250097418089*^9}, {3.625250128659973*^9, 3.6252504325521183`*^9}, {
   3.6252504775912237`*^9, 3.625250641855032*^9}, {3.625250714575644*^9, 
   3.625250731870205*^9}, {3.625250875377135*^9, 3.6252509945247836`*^9}, {
   3.6252510265571966`*^9, 3.6252511269933357`*^9}, {3.6252512327240143`*^9, 
   3.6252512780623207`*^9}, {3.625251341913005*^9, 3.625251359828981*^9}, {
   3.6252514432657566`*^9, 3.6252514780800295`*^9}, {3.6252515237815795`*^9, 
   3.625251752446437*^9}, {3.625251840979617*^9, 3.6252520007764397`*^9}, {
   3.6252520495280285`*^9, 3.625252051270195*^9}, {3.6252521348000307`*^9, 
   3.6252521583647814`*^9}, {3.6252522760214343`*^9, 
   3.6252522772412496`*^9}, {3.625252350495217*^9, 3.6252524194353027`*^9}, {
   3.625252493949112*^9, 3.6252524953800697`*^9}, {3.6252525299711957`*^9, 
   3.62525254700858*^9}, {3.6252525973542376`*^9, 3.625252621603448*^9}, 
   3.625287713091472*^9, {3.6252878957917404`*^9, 3.625288281893347*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Part", "::", "pkspec1"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"The expression \[NoBreak]\\!\\(i3\\)\[NoBreak] cannot be \
used as a part specification. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, ButtonData:>\\\"paclet:ref/Part\
\\\", ButtonNote -> \\\"Part::pkspec1\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{
  3.6252523691006536`*^9, 3.6252524971292367`*^9, 3.625252549707385*^9, {
   3.625252605994011*^9, 3.6252526313949904`*^9}, {3.625287810757238*^9, 
   3.6252878110052624`*^9}, 3.625288236536812*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Part", "::", "pkspec1"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"The expression \[NoBreak]\\!\\(i4\\)\[NoBreak] cannot be \
used as a part specification. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, ButtonData:>\\\"paclet:ref/Part\
\\\", ButtonNote -> \\\"Part::pkspec1\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{
  3.6252523691006536`*^9, 3.6252524971292367`*^9, 3.625252549707385*^9, {
   3.625252605994011*^9, 3.6252526313949904`*^9}, {3.625287810757238*^9, 
   3.6252878110052624`*^9}, 3.6252882366118193`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Part", "::", "pkspec1"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"The expression \[NoBreak]\\!\\(i3\\)\[NoBreak] cannot be \
used as a part specification. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, ButtonData:>\\\"paclet:ref/Part\
\\\", ButtonNote -> \\\"Part::pkspec1\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{
  3.6252523691006536`*^9, 3.6252524971292367`*^9, 3.625252549707385*^9, {
   3.625252605994011*^9, 3.6252526313949904`*^9}, {3.625287810757238*^9, 
   3.6252878110052624`*^9}, 3.6252882366878266`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"General", "::", "stop"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Further output of \[NoBreak]\\!\\(\\*StyleBox[\\(Part :: \
pkspec1\\), \\\"MessageName\\\"]\\)\[NoBreak] will be suppressed during this \
calculation. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/stop\\\", ButtonNote -> \
\\\"General::stop\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{
  3.6252523691006536`*^9, 3.6252524971292367`*^9, 3.625252549707385*^9, {
   3.625252605994011*^9, 3.6252526313949904`*^9}, {3.625287810757238*^9, 
   3.6252878110052624`*^9}, 3.6252882367168293`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "1", ",", "1", ",", "14", ",", "0"}], "}"}]], "Input",
 CellChangeTimes->{3.6252495047338934`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "1", ",", "1", ",", "14", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{{3.6252414459777746`*^9, 3.6252414460559053`*^9}, 
   3.6252417016636167`*^9, 3.6252417344655914`*^9, 3.6252418393930416`*^9, 
   3.625242011261546*^9, {3.6252422986205626`*^9, 3.62524231196502*^9}, 
   3.6252423907973337`*^9, 3.625242432112029*^9, 3.6252425078504267`*^9, {
   3.625242562712716*^9, 3.625242584963899*^9}, 3.6252426642649856`*^9, 
   3.6252426995949883`*^9, 3.6252428921520915`*^9, {3.6252429257320023`*^9, 
   3.625242941060941*^9}, 3.6252430027517185`*^9, 3.625243033284591*^9, 
   3.6252430634893208`*^9, 3.625243106538481*^9, 3.6252431825268955`*^9, 
   3.625243223294684*^9, {3.625243255968297*^9, 3.625243304127103*^9}, {
   3.625243348723224*^9, 3.625243369599331*^9}, {3.6252434079138684`*^9, 
   3.625243455541397*^9}, {3.625243509903663*^9, 3.625243528389017*^9}, {
   3.625243568063001*^9, 3.6252435948925514`*^9}, {3.6252436292850027`*^9, 
   3.625243650817398*^9}, 3.6252436926633687`*^9, {3.625243755510459*^9, 
   3.625243760776364*^9}, 3.625244918972217*^9, 3.6252467979214535`*^9, 
   3.625248095674969*^9, 3.6252483135946436`*^9, 3.6252483444973*^9, 
   3.6252483758902855`*^9, 3.6252484092455835`*^9, 3.625248619071847*^9, 
   3.6252487003812017`*^9, {3.6252487484043026`*^9, 3.625248772055112*^9}, 
   3.625248840412808*^9, {3.6252489222495155`*^9, 3.6252489339353247`*^9}, 
   3.6252489671275134`*^9, {3.625249073431575*^9, 3.6252491031724577`*^9}, {
   3.6252491369570417`*^9, 3.6252491486318464`*^9}, 3.6252491949147882`*^9, {
   3.625249233457549*^9, 3.625249318376316*^9}, {3.625249413386829*^9, 
   3.625249455709119*^9}, 3.6252495047589083`*^9}]
}, Open  ]]
},
WindowSize->{1177, 1102},
WindowMargins->{{Automatic, 222}, {Automatic, 0}},
FrontEndVersion->"10.0 for Microsoft Windows (64-bit) (July 1, 2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 28727, 640, 2133, "Code"],
Cell[29310, 664, 627, 12, 21, "Message"],
Cell[29940, 678, 629, 12, 21, "Message"],
Cell[30572, 692, 629, 12, 21, "Message"],
Cell[31204, 706, 709, 14, 21, "Message"]
}, Open  ]],
Cell[CellGroupData[{
Cell[31950, 725, 147, 3, 31, "Input"],
Cell[32100, 730, 1713, 24, 31, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
